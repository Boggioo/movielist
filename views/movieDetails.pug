extends layout

block content
  .container.mt-5
    .row
      .col-lg-4.mb-4
        .card.border-0.shadow
          if movie.poster_path
            img.card-img-top.rounded-top(src=`https://image.tmdb.org/t/p/w500${movie.poster_path}` alt=movie.title)
          else
            .bg-light.text-center.py-5.rounded-top
              i.bi.bi-film.fs-1
          .card-body.p-4
            if user
              form.d-grid.gap-2(action=`/favorite/${movie.id}` method='POST')
                button.btn.btn-primary.btn-lg(type='submit')
                  i.bi.bi-heart-fill.me-2
                  | Aggiungi ai Preferiti
            else
              a.btn.btn-primary.btn-lg.d-block(href='/login')
                i.bi.bi-heart-fill.me-2
                | Accedi per aggiungere ai preferiti
            a.btn.btn-outline-secondary.mt-2.d-block(href='/')
              i.bi.bi-arrow-left.me-2
              | Torna alla Homepage
      
      .col-lg-8
        .card.border-0.shadow
          .card-body.p-4
            h1.card-title.mb-4= movie.title
            
            .d-flex.align-items-center.mb-4
              if movie.release_date
                span.text-muted.me-4
                  i.bi.bi-calendar-event.me-2
                  | #{new Date(movie.release_date).getFullYear()}
              
              if movie.vote_average
                span.badge.bg-warning.text-dark.p-2
                  i.bi.bi-star-fill.me-1
                  | #{movie.vote_average.toFixed(1)}/10
            
            if movie.overview
              .card.bg-light.border-0.mb-4
                .card-body
                  p.card-text.mb-0= movie.overview
            
            if movie.genres && movie.genres.length
              .mb-4
                h4.text-primary.mb-3 Generi
                .d-flex.flex-wrap.gap-2
                  each genre in movie.genres
                    span.badge.bg-secondary.p-2= genre.name
            
            if movie.cast && movie.cast.length
              h4.text-primary.mb-3 Cast Principale
              .row.g-3
                each actor in movie.cast
                  .col-md-6
                    .card.bg-light.border-0
                      .card-body.py-2
                        .d-flex.align-items-center
                          i.bi.bi-person-circle.me-2.fs-4
                          span= actor.name
            
            if movie.director
              .mb-4
                h4.text-primary.mb-3 Regista
                .card.bg-light.border-0
                  .card-body.py-2
                    .d-flex.align-items-center
                      i.bi.bi-camera-reels.me-2.fs-4
                      span= movie.director.name
            
            if movie.trailer
              .mb-4
                h4.text-primary.mb-3 Trailer
                .ratio.ratio-16x9.mb-3
                  iframe(src=`https://www.youtube.com/embed/${movie.trailer.key}` allowfullscreen)
            
            if movie.streamingProviders && movie.streamingProviders.length
              .mb-4
                h4.text-primary.mb-3 Disponibile su
                .d-flex.flex-wrap.gap-3
                  each provider in movie.streamingProviders
                    .text-center
                      if provider.logo_path
                        img.rounded.shadow-sm(src=`https://image.tmdb.org/t/p/w92${provider.logo_path}` alt=provider.provider_name width="50" height="50")
                        .small.mt-1= provider.provider_name

